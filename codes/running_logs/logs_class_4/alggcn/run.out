Running with seed:  4
Running ALG model
T: 19
Number of classes: 11
Total number of nodes: 2163
The number of nodes for label: 220
initial_num_per_class: 2
ititial_labeled_nodes: 40
batch_sizes_per_class: [2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
batch_sizes: [22 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11]
alphas: [1.0, 0.9965844930066698, 0.9863613034027223, 0.9694002659393304, 0.9458172417006346, 0.9157733266550574, 0.8794737512064891, 0.8371664782625287, 0.7891405093963936, 0.7357239106731317, 0.6772815716257411, 0.6142127126896679, 0.5469481581224269, 0.47594739303707345, 0.40169542465296953, 0.32469946920468357, 0.24548548714079924, 0.16459459028073375, 0.0825793454723324, 6.123233995736766e-17]
batch_epochs: [121 116 112 107 102  97  93  88  83  78  74  69  64  60  55  50  45  41
  36]

[STEP 1]: Upload hostg.class dataset.
| # of nodes : 2286
| # of edges : 38161.0
| # of features : (2286, 512)
| # of classes   : 11
number of nan: 0
Label distribution of the dataset:
0     778
1     506
2     433
3     127
4      92
5      64
6      50
7      50
8      29
9      21
10     13
dtype: int64
| # of maximum train set : 238
| # of all train set (including the val set): 1627
| # of val set   : 500
| # of test set  : 536
| # of labels : torch.Size([2163])
tested on a dropout graph with rate:  0.0
Number of edges after deletion:  38161.0
Overview of adjacency martrix  (2286, 2286)
[ True  True  True ...  True  True  True]
Number of clusters: 11
(2163,)
(11, 512)
(2163,)
Validation loss decreased (inf --> 1.721).  Saving model ...
############################################################################
GCN Epoch 010
train_loss: 1.8422, val_loss: 1.9722
current val_acc: 0.3220 
current test_acc: 0.3116 
############################################################################
Validation loss decreased (1.721 --> 1.584).  Saving model ...
Validation loss decreased (1.584 --> 1.418).  Saving model ...
Validation loss decreased (1.418 --> 1.357).  Saving model ...
Validation loss decreased (1.357 --> 1.277).  Saving model ...
Validation loss decreased (1.277 --> 1.270).  Saving model ...
############################################################################
GCN Epoch 020
train_loss: 1.3831, val_loss: 1.5735
current val_acc: 0.3480 
current test_acc: 0.3470 
############################################################################
Validation loss decreased (1.270 --> 1.255).  Saving model ...
############################################################################
GCN Epoch 030
train_loss: 1.0874, val_loss: 1.6207
current val_acc: 0.3560 
current test_acc: 0.3433 
############################################################################
############################################################################
GCN Epoch 040
train_loss: 1.2933, val_loss: 1.6246
current val_acc: 0.4080 
current test_acc: 0.3899 
############################################################################
############################################################################
GCN Epoch 050
train_loss: 0.9777, val_loss: 1.7059
current val_acc: 0.4100 
current test_acc: 0.4142 
############################################################################
Validation loss decreased (1.255 --> 1.250).  Saving model ...
Validation loss decreased (1.250 --> 1.225).  Saving model ...
############################################################################
GCN Epoch 060
train_loss: 0.9976, val_loss: 1.7398
current val_acc: 0.4220 
current test_acc: 0.4123 
############################################################################
############################################################################
GCN Epoch 070
train_loss: 0.9678, val_loss: 1.3785
current val_acc: 0.5020 
current test_acc: 0.4832 
############################################################################
############################################################################
GCN Epoch 080
train_loss: 0.7415, val_loss: 1.4466
current val_acc: 0.5280 
current test_acc: 0.5373 
############################################################################
############################################################################
GCN Epoch 090
train_loss: 0.8465, val_loss: 1.4846
current val_acc: 0.5480 
current test_acc: 0.5317 
############################################################################
############################################################################
GCN Epoch 100
train_loss: 0.7599, val_loss: 1.4717
current val_acc: 0.4900 
current test_acc: 0.4776 
############################################################################
############################################################################
GCN Epoch 110
train_loss: 0.8705, val_loss: 1.4754
current val_acc: 0.5140 
current test_acc: 0.5187 
############################################################################
############################################################################
GCN Epoch 120
train_loss: 0.8289, val_loss: 1.4695
current val_acc: 0.5140 
current test_acc: 0.5168 
############################################################################
Optimization Finished!
Total time elapsed: 1.2953s
0.624 0.6268656716417911
0.5640000000000001 0.5373134328358209
0.558 0.5503731343283582
0.552 0.5615671641791045
0.548 0.5317164179104478
0.546 0.539179104477612
0.544 0.542910447761194
0.542 0.5130597014925373
0.54 0.539179104477612
0.538 0.5167910447761194
Result of 1st iteration of MLP acc_val: 0.5140 acc_test: 0.5168
tensor
number of labeled nodes per class: [4 4 4 4 4 4 4 3 2 3 4]
Batch size: 1
number of nodes to be labeled per class: [0 0 0 0 0 0 0 1 2 1 0]
number of available nodes per class:
 0     142
1     211
2     120
3      85
4     146
5     110
6     124
7      54
8      74
9       7
10     14
dtype: int64
number of labeled nodes per class after cut_zero: [0 0 0 0 0 0 0 1 2 1 0]
number of labeled nodes per class after average_ab: [0 0 0 0 0 0 0 1 2 1 0]
iniitially labeled len of idx_train: 40
Validation loss decreased (inf --> 2.058).  Saving model ...
Validation loss decreased (2.058 --> 1.940).  Saving model ...
Validation loss decreased (1.940 --> 1.782).  Saving model ...
############################################################################
GCN Epoch 010
train_loss: 1.5688, val_loss: 1.6905
current val_acc: 0.4580 
current test_acc: 0.4851 
############################################################################
Validation loss decreased (1.782 --> 1.690).  Saving model ...
Validation loss decreased (1.690 --> 1.643).  Saving model ...
Validation loss decreased (1.643 --> 1.476).  Saving model ...
############################################################################
GCN Epoch 020
train_loss: 1.2289, val_loss: 1.9009
current val_acc: 0.5420 
current test_acc: 0.5224 
############################################################################
############################################################################
GCN Epoch 030
train_loss: 0.8806, val_loss: 1.7972
current val_acc: 0.5280 
current test_acc: 0.5168 
############################################################################
Validation loss decreased (1.476 --> 1.462).  Saving model ...
Validation loss decreased (1.462 --> 1.445).  Saving model ...
Validation loss decreased (1.445 --> 1.363).  Saving model ...
############################################################################
GCN Epoch 040
train_loss: 0.7602, val_loss: 1.6331
current val_acc: 0.4720 
current test_acc: 0.4590 
############################################################################
Validation loss decreased (1.363 --> 1.321).  Saving model ...
############################################################################
GCN Epoch 050
train_loss: 0.7453, val_loss: 1.3833
current val_acc: 0.5320 
current test_acc: 0.5019 
############################################################################
############################################################################
GCN Epoch 060
train_loss: 0.8688, val_loss: 1.5801
current val_acc: 0.5320 
current test_acc: 0.5149 
############################################################################
Validation loss decreased (1.321 --> 1.213).  Saving model ...
############################################################################
GCN Epoch 070
train_loss: 0.7699, val_loss: 1.7562
current val_acc: 0.5220 
current test_acc: 0.5373 
############################################################################
############################################################################
GCN Epoch 080
train_loss: 0.8521, val_loss: 1.7308
current val_acc: 0.4800 
current test_acc: 0.4403 
############################################################################
############################################################################
GCN Epoch 090
train_loss: 0.7515, val_loss: 1.7104
current val_acc: 0.5220 
current test_acc: 0.5410 
############################################################################
############################################################################
GCN Epoch 100
train_loss: 0.7125, val_loss: 1.4831
current val_acc: 0.6100 
current test_acc: 0.5989 
############################################################################
############################################################################
GCN Epoch 110
train_loss: 0.7189, val_loss: 1.7277
current val_acc: 0.4600 
current test_acc: 0.4571 
############################################################################
############################################################################
GCN Epoch 120
train_loss: 0.6548, val_loss: 1.2643
current val_acc: 0.5800 
current test_acc: 0.6063 
############################################################################
############################################################################
GCN Epoch 130
train_loss: 0.6483, val_loss: 1.4918
current val_acc: 0.5460 
current test_acc: 0.5466 
############################################################################
############################################################################
GCN Epoch 140
train_loss: 0.6270, val_loss: 1.5169
current val_acc: 0.6020 
current test_acc: 0.6026 
############################################################################
############################################################################
GCN Epoch 150
train_loss: 0.5571, val_loss: 1.5490
current val_acc: 0.5720 
current test_acc: 0.5410 
############################################################################
############################################################################
GCN Epoch 160
train_loss: 0.5526, val_loss: 1.4503
current val_acc: 0.5440 
current test_acc: 0.5597 
############################################################################
Early stopped at epoch:  167
Optimization Finished!
Test accuracy of the best model: 0.5914
Total time elapsed: 1.3905s
Best 10 checkpoints: 
0.646 0.6417910447761194
0.644 0.6119402985074627
0.642 0.6212686567164178
0.628 0.6175373134328358
0.614 0.6007462686567164
0.612 0.5914179104477612
0.61 0.5988805970149254
0.604 0.6324626865671642
0.602 0.6026119402985074
0.6 0.6138059701492538
len of idx_available_temp initial: 1087
len of idx_available_temp: 135
